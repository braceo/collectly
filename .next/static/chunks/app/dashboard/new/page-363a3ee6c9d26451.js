(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[215],{2030:function(e,t,r){Promise.resolve().then(r.bind(r,7515))},7515:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n}});var s=r(3827),i=r(4090),a=r(1097),l=r(7907);function n(){let e=(0,i.useMemo)(()=>(0,a.W)(),[]),t=(0,l.useRouter)(),[r,n]=(0,i.useState)([]),[d,c]=(0,i.useState)(!1),[o,u]=(0,i.useState)(null);async function m(r){u(null),c(!0);let s=String(r.get("title")||"").trim(),i=String(r.get("description")||"").trim(),a=String(r.get("price")||"0").trim(),l=Number(r.get("category_id")||0),n=Number(r.get("stock_quantity")||0),d="on"===r.get("in_stock");if(!s)return u("Title is required."),c(!1);if(!l)return u("Pick a category."),c(!1);let o=Math.round(100*Number(a));if(!Number.isFinite(o)||o<0)return u("Price must be valid."),c(!1);let{data:{user:m},error:p}=await e.auth.getUser();if(p||!m){u("Not authenticated."),c(!1);return}let{error:b}=await e.from("products").insert({seller_id:m.id,title:s,description:i,price_cents:o,category_id:l,stock_quantity:n,in_stock:d});if(c(!1),b){console.error(b),u(b.message);return}alert("Product created."),t.push("/dashboard")}return(0,i.useEffect)(()=>{(async()=>{let{data:t,error:r}=await e.from("categories").select("id,name").order("name",{ascending:!0});r?(console.error(r),u("Failed to load categories.")):n(null!=t?t:[])})()},[e]),(0,s.jsxs)("form",{action:m,className:"space-y-4 bg-white rounded-2xl shadow p-6",children:[o&&(0,s.jsx)("div",{className:"text-sm text-red-600 border border-red-200 bg-red-50 rounded p-2",children:o}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Title *"}),(0,s.jsx)("input",{name:"title",required:!0,className:"w-full border rounded-lg px-3 py-2",placeholder:"e.g. Handmade mug"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Description"}),(0,s.jsx)("textarea",{name:"description",rows:4,className:"w-full border rounded-lg px-3 py-2",placeholder:"Short details..."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Price (\xa3)"}),(0,s.jsx)("input",{name:"price",type:"number",step:"0.01",min:"0",required:!0,className:"w-full border rounded-lg px-3 py-2",placeholder:"12.99"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Category"}),(0,s.jsxs)("select",{name:"category_id",required:!0,className:"w-full border rounded-lg px-3 py-2",children:[(0,s.jsx)("option",{value:"",children:"Select…"}),r.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Stock quantity"}),(0,s.jsx)("input",{name:"stock_quantity",type:"number",min:"0",defaultValue:0,className:"w-full border rounded-lg px-3 py-2"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2 mt-6",children:[(0,s.jsx)("input",{name:"in_stock",type:"checkbox",defaultChecked:!0,className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"In stock"})]})]}),(0,s.jsx)("button",{type:"submit",disabled:d,className:"rounded-lg px-4 py-2 bg-black text-white disabled:opacity-50",children:d?"Saving…":"Create product"})]})}},1097:function(e,t,r){"use strict";r.d(t,{W:function(){return i}});var s=r(8714);let i=()=>(0,s.createBrowserSupabaseClient)()}},function(e){e.O(0,[785,971,69,744],function(){return e(e.s=2030)}),_N_E=e.O()}]);